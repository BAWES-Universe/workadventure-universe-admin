# Development Dockerfile for Admin API
# Runs behind Traefik at admin.bawes.localhost

FROM node:20-alpine

WORKDIR /app

# Copy package files
COPY package*.json ./

# Install dependencies (skip postinstall to avoid prisma generate during build)
RUN npm install --ignore-scripts

# Copy all source code (needed for prisma generate and initial build)
COPY . .

# Generate Prisma Client (now that all files are in place)
# DATABASE_URL is required by prisma.config.ts but not used during generate
RUN DATABASE_URL="postgresql://dummy:dummy@dummy:5432/dummy" npx prisma generate

# Expose port (used by Traefik)
EXPOSE 3333

# Start development server
# Next.js dev server binds to 0.0.0.0 by default in Docker
CMD ["npm", "run", "dev"]

